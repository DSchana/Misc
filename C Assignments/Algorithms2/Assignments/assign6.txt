Script started on Mon Apr 10 12:10:45 2017
bash-3.2$ cat assign6.c
/*
 * Title:	assign6.c
 * Author:	Dilpreet Chana
 * Created:	April 5, 2017
 * Last Edit:	April 10, 2017
 * Description:	Read the students' data from a file and
 *		sort them in palce by id. Write the sorted
 *		students data to another file for saving
**/

#include <stdio.h>

struct student {
	int id;
	float marks[10];
	float gpa;
};
typedef struct student Student;

int main() {
	// Open files
	FILE *in  = fopen("assign6.dat", "r");
	FILE *out = fopen("assign6out.dat", "w+");
	FILE *sort_out = fopen("assign6res.dat", "w");

	Student curr, comp;  // Student instances for sorting

	size_t tot_bytes = 0;
	size_t bytes_in = 0;

	fseek(in, 0, SEEK_END);
	bytes_in = ftell(in);
	fseek(in, 0, SEEK_SET);

	// Read input file
	while (1) {
		Student tmp;

		for (int i = -1; i < 10; i++) {
			if (i == -1) {
				fscanf(in, "%d", &tmp.id);
				continue;
			}
			else {
				fscanf(in, "%f", &(tmp.marks[i]));
			}
		}

		if (feof(in)) break;

		tmp.gpa = 0;
		for (int i = 0; i < 10; i++) {
			tmp.gpa += tmp.marks[i];
		}
		tmp.gpa /= 10;

		fwrite(&tmp, sizeof(Student), 1, out);
		tot_bytes += sizeof(Student);
	}

	// Sort students from direct access file
	fseek(out, 0, SEEK_SET);

	for (int i = 0; i < tot_bytes / sizeof(Student); i++) {
		for (int j = 0; j < (tot_bytes / sizeof(Student)) - 1; j++) {
			fseek(out, j * sizeof(Student), SEEK_SET);
			fread(&curr, sizeof(Student), 1, out);
			fread(&comp, sizeof(Student), 1, out);

			if (curr.id > comp.id) {
				fseek(out, j * sizeof(Student), SEEK_SET);
				fwrite(&comp, sizeof(Student), 1, out);
				fwrite(&curr, sizeof(Student), 1, out);
			}
		}
	}

	// Write sorted list to file
	fseek(out, 0, SEEK_SET);
	for (int i = 0; i < tot_bytes / sizeof(Student); i++) {
		Student tmp;
		fread(&tmp, sizeof(tmp), 1, out);
		fprintf(sort_out, "%06d: %.1f, %.1f, %.1f, %.1f, %.1f, %.1f, %.1f, %.1f, %.1f, %.1f;  Average: %.1f\n", tmp.id,
															tmp.marks[0],
                                                                                                                        tmp.marks[1],
                                                                                                                        tmp.marks[2],
                                                                                                                        tmp.marks[3],
                                                                                                                        tmp.marks[4],
                                                                                                                        tmp.marks[5],
                                                                                                                        tmp.marks[6],
                                                                                                                        tmp.marks[7],
                                                                                                                        tmp.marks[8],
                                                                                                                        tmp.marks[9],
															tmp.gpa);
	}

	fprintf(sort_out, "%zu\n%zu\n", bytes_in, tot_bytes);

	fclose(in);
	fclose(out);
	fclose(sort_out);

	return 0;
}
bash-3.2$ ls -c[Kl
total 528
-rwxr-xr-x  1 DSchana  staff   8624 27 Jan 23:47 assign1
-rw-r--r--  1 DSchana  staff   1946 27 Jan 23:46 assign1.c
-rw-r--r--  1 DSchana  staff   3162 27 Jan 23:47 assign1.txt
-rwxr-xr-x  1 DSchana  staff   8828 12 Feb 21:24 assign2
-rw-r--r--  1 DSchana  staff   3808 12 Feb 21:23 assign2.c
-rw-r--r--  1 DSchana  staff   4911 12 Feb 21:24 assign2.txt
-rwxr-xr-x  1 DSchana  staff  13448 12 Mar 23:47 assign3
-rw-r--r--  1 DSchana  staff   4239 12 Mar 23:54 assign3.c
-rw-r--r--  1 DSchana  staff  71333 12 Mar 22:22 assign3.exe
-rw-r--r--  1 DSchana  staff   6375 12 Mar 23:46 assign3.txt
-rwxr-xr-x  1 DSchana  staff  13548 25 Mar 18:25 assign4
-rw-r--r--  1 DSchana  staff   5357 27 Mar 17:58 assign4.c
-rw-r--r--  1 DSchana  staff   7929 25 Mar 18:25 assign4.txt
-rwxr-xr-x  1 DSchana  staff  13588 30 Mar 00:36 assign5
-rw-r--r--  1 DSchana  staff   7008 29 Mar 23:09 assign5.c
-rw-r--r--  1 DSchana  staff   9772 30 Mar 00:37 assign5.txt
-rwxr-xr-x  1 DSchana  staff   8792 10 Apr 12:03 assign6
-rw-r--r--  1 DSchana  staff   3270 10 Apr 12:10 assign6.c
-rw-r--r--  1 DSchana  staff    570 10 Apr 12:02 assign6.dat
-rw-r--r--  1 DSchana  staff     43 10 Apr 12:10 assign6.txt
-rw-r--r--  1 DSchana  staff    480 10 Apr 12:03 assign6out.dat
-rw-r--r--  1 DSchana  staff    838 10 Apr 12:03 assign6res.dat
-rw-r--r--  1 DSchana  staff    121 25 Mar 03:25 courses.txt
-rw-r--r--  1 DSchana  staff     14 26 Jan 10:21 input1.txt
-rw-r--r--  1 DSchana  staff    176 12 Mar 22:22 input3.txt
-rw-r--r--  1 DSchana  staff     57 30 Mar 00:37 studentList.txt
bash-3.2$ gcc assign6.c -o assign6
bash-3.2$ ./assign6
bash-3.2$ cat ass6[Kign6res.dat [K
000000: 65.0, 24.8, 98.6, 37.5, 45.7, 44.3, 98.9, 19.3, 55.9, 17.6;  Average: 50.8
111111: 85.0, 84.8, 28.6, 67.5, 45.7, 74.3, 28.9, 39.3, 95.9, 13.6;  Average: 56.4
222222: 95.0, 14.8, 58.6, 27.5, 65.7, 34.3, 78.9, 29.3, 85.9, 12.6;  Average: 50.3
333333: 95.0, 14.8, 58.6, 97.5, 65.7, 34.3, 78.9, 29.3, 85.9, 25.6;  Average: 58.6
444444: 98.0, 34.8, 55.6, 97.5, 55.7, 34.2, 78.9, 89.3, 85.9, 24.6;  Average: 65.4
555555: 45.0, 54.8, 28.6, 47.5, 95.7, 34.3, 78.9, 29.3, 35.9, 15.6;  Average: 46.6
666666: 75.0, 44.8, 88.6, 27.5, 85.7, 94.3, 38.9, 59.3, 25.9, 19.6;  Average: 56.0
777777: 55.0, 44.8, 68.6, 37.5, 35.7, 94.3, 28.9, 39.3, 15.9, 17.6;  Average: 43.8
888888: 15.0, 74.8, 28.6, 57.5, 35.7, 24.3, 18.9, 39.3, 35.9, 18.6;  Average: 34.9
999999: 35.0, 34.8, 78.6, 67.5, 65.7, 34.3, 18.9, 79.3, 55.9, 14.6;  Average: 48.5
570
480
bash-3.2$ ls -l
total 536
-rwxr-xr-x  1 DSchana  staff   8624 27 Jan 23:47 assign1
-rw-r--r--  1 DSchana  staff   1946 27 Jan 23:46 assign1.c
-rw-r--r--  1 DSchana  staff   3162 27 Jan 23:47 assign1.txt
-rwxr-xr-x  1 DSchana  staff   8828 12 Feb 21:24 assign2
-rw-r--r--  1 DSchana  staff   3808 12 Feb 21:23 assign2.c
-rw-r--r--  1 DSchana  staff   4911 12 Feb 21:24 assign2.txt
-rwxr-xr-x  1 DSchana  staff  13448 12 Mar 23:47 assign3
-rw-r--r--  1 DSchana  staff   4239 12 Mar 23:54 assign3.c
-rw-r--r--  1 DSchana  staff  71333 12 Mar 22:22 assign3.exe
-rw-r--r--  1 DSchana  staff   6375 12 Mar 23:46 assign3.txt
-rwxr-xr-x  1 DSchana  staff  13548 25 Mar 18:25 assign4
-rw-r--r--  1 DSchana  staff   5357 27 Mar 17:58 assign4.c
-rw-r--r--  1 DSchana  staff   7929 25 Mar 18:25 assign4.txt
-rwxr-xr-x  1 DSchana  staff  13588 30 Mar 00:36 assign5
-rw-r--r--  1 DSchana  staff   7008 29 Mar 23:09 assign5.c
-rw-r--r--  1 DSchana  staff   9772 30 Mar 00:37 assign5.txt
-rwxr-xr-x  1 DSchana  staff   8792 10 Apr 12:11 assign6
-rw-r--r--  1 DSchana  staff   3270 10 Apr 12:10 assign6.c
-rw-r--r--  1 DSchana  staff    570 10 Apr 12:02 assign6.dat
-rw-r--r--  1 DSchana  staff   6023 10 Apr 12:11 assign6.txt
-rw-r--r--  1 DSchana  staff    480 10 Apr 12:11 assign6out.dat
-rw-r--r--  1 DSchana  staff    838 10 Apr 12:11 assign6res.dat
-rw-r--r--  1 DSchana  staff    121 25 Mar 03:25 courses.txt
-rw-r--r--  1 DSchana  staff     14 26 Jan 10:21 input1.txt
-rw-r--r--  1 DSchana  staff    176 12 Mar 22:22 input3.txt
-rw-r--r--  1 DSchana  staff     57 30 Mar 00:37 studentList.txt
bash-3.2$ exit
exit

Script done on Mon Apr 10 12:11:54 2017
